# Proteus仿真芯片替换说明

## 目标
将仿真中的 **AT89C52** 芯片替换为 **STC89C516** 芯片

## 操作步骤

### 方法一：直接替换芯片（推荐）

1. **打开Proteus仿真文件**
   - 双击打开 `仿真/双人弹球游戏仿真.pdsprj`

2. **选择AT89C52芯片**
   - 在设计窗口中，单击选中AT89C52芯片（会出现红色选择框）

3. **删除旧芯片**
   - 按 `Delete` 键删除AT89C52芯片
   - 注意：删除前记住芯片的位置和引脚连接

4. **添加STC89C516芯片**
   - 点击左侧工具栏的 `P` 按钮（Pick from Libraries）
   - 在搜索框中输入 `STC89C516` 或 `89C516`
   - 如果找不到STC89C516，可以使用 `AT89C52` 作为替代（引脚兼容）
   - 双击选中的芯片型号

5. **放置新芯片**
   - 将鼠标移动到原来芯片的位置
   - 单击放置芯片
   - 右键退出放置模式

6. **重新连接引脚**
   - 检查所有引脚连接是否正确
   - 主要连接：
     - P0口 → LED点阵屏行驱动
     - P3.4 → 74HC595 SER
     - P3.5 → 74HC595 RCLK
     - P3.6 → 74HC595 SRCLK
     - P3.0 → 按键K2
     - P3.1 → 按键K1
     - P1口 → 玩家2按键
     - VCC、GND、晶振等

7. **配置芯片参数**
   - 双击STC89C516芯片
   - 在弹出的属性窗口中设置：
     - Program File: 选择编译生成的 `.hex` 文件（`CODE/Objects/Project.hex`）
     - Clock Frequency: 12MHz

8. **保存文件**
   - 按 `Ctrl+S` 保存
   - 建议另存为新文件，保留原始仿真文件作为备份

### 方法二：修改芯片属性（如果Proteus中没有STC89C516）

如果Proteus元件库中没有STC89C516，可以继续使用AT89C52进行仿真，因为：

1. **引脚兼容**：STC89C516与AT89C52引脚完全兼容
2. **指令集兼容**：都是标准的8051指令集
3. **仿真效果**：对于本项目的功能仿真，两者没有区别

**唯一需要注意的差异**：
- AT89C52：8KB ROM，256字节RAM
- STC89C516：64KB ROM，1280字节RAM

本项目代码量很小，不会超出AT89C52的容量限制，因此可以继续使用AT89C52进行仿真。

### 方法三：添加STC芯片库（高级）

如果需要使用真实的STC89C516芯片模型：

1. **下载STC芯片库**
   - 访问STC官网或相关论坛下载Proteus的STC芯片库文件
   - 通常是 `.LIB` 和 `.IDX` 文件

2. **安装芯片库**
   - 将库文件复制到Proteus安装目录的 `LIBRARY` 文件夹
   - 例如：`C:\Program Files\Labcenter Electronics\Proteus 8 Professional\LIBRARY\`

3. **重启Proteus**
   - 关闭并重新打开Proteus
   - 在元件库中搜索STC89C516

4. **按照方法一替换芯片**

## 验证步骤

替换芯片后，请进行以下验证：

1. **检查连接**
   - 确认所有引脚连接正确
   - 特别注意电源（VCC、GND）和晶振连接

2. **加载程序**
   - 确认芯片属性中的Program File路径正确
   - 指向最新编译的 `Project.hex` 文件

3. **运行仿真**
   - 点击左下角的播放按钮开始仿真
   - 观察LED点阵屏是否正常显示
   - 测试按键是否响应

4. **功能测试**
   - 测试开始界面显示
   - 测试游戏运行
   - 测试按键控制
   - 测试胜利界面

## 常见问题

### Q1: 找不到STC89C516芯片
**A**: 使用AT89C52代替，两者引脚和功能兼容，不影响仿真效果。

### Q2: 替换后仿真无法运行
**A**: 检查以下几点：
- 芯片的Program File是否正确加载
- 晶振频率是否设置为12MHz
- 所有引脚连接是否完整
- VCC和GND是否正确连接

### Q3: LED点阵屏不显示
**A**: 检查：
- P0口和74HC595的连接
- 74HC595的电源和时钟信号
- 程序是否正确加载

### Q4: 按键无响应
**A**: 检查：
- 按键连接到正确的引脚（P3.0、P3.1、P1口）
- 按键的上拉电阻配置
- 按键的另一端是否接地

## 建议

1. **保留备份**：替换前先备份原始仿真文件
2. **使用AT89C52**：如果只是功能验证，继续使用AT89C52即可
3. **测试验证**：替换后务必进行完整的功能测试
4. **文档更新**：如果使用AT89C52仿真，在文档中说明"仿真使用AT89C52，实际硬件使用STC89C516"

## 总结

对于本项目：
- **代码层面**：已修改为STC89C516
- **Keil项目**：已配置为STC89C516
- **仿真层面**：可以继续使用AT89C52（引脚兼容）
- **实际硬件**：使用STC89C516芯片

这样既保证了代码的正确性，又不影响仿真验证。

