# 基于51单片机的双人弹球游戏

## 项目简介

这是一个基于STC89C516单片机的双人对战弹球游戏，通过8×8 LED点阵屏显示游戏画面，实现了类似乒乓球的双人对战游戏体验。

## 硬件配置

- **主控芯片**：STC89C516单片机
  - 工作频率：12MHz
  - 片上RAM：1280字节
  - 片上ROM：64KB
- **显示模块**：8×8 LED点阵屏
- **驱动芯片**：74HC595移位寄存器
- **输入模块**：4个按键

## 主要功能

1. **开始界面**：显示"K1 TO START"滚动字幕
2. **游戏界面**：双人对战弹球游戏
3. **玩家操作**：通过按键控制球拍上下移动
4. **碰撞检测**：球自动移动和反弹
5. **胜负判定**：未接住球则对方获胜
6. **胜利界面**：显示获胜玩家动画
7. **自动重启**：游戏结束后自动返回开始界面

## 项目结构

```
.
├── CODE/                    # 源代码目录
│   ├── main.c              # 主程序
│   ├── MatrixLED.c/h       # LED点阵屏驱动
│   ├── Delay.c/h           # 延时函数
│   ├── Timer0Init.h        # 定时器初始化
│   ├── StartGame.h         # 开始界面
│   ├── WIN1.h              # 玩家1胜利界面
│   ├── WIN2.h              # 玩家2胜利界面
│   └── Project.uvproj      # Keil项目文件
├── 仿真/                    # Proteus仿真文件
│   └── 双人弹球游戏仿真.pdsprj
├── 实验报告.md              # 详细实验报告
├── 答辩发言稿.md            # 答辩演讲稿
└── README.md               # 本文件

```

## 开发环境

- **IDE**：Keil uVision (C51)
- **仿真软件**：Proteus 8.x
- **编程语言**：C语言

## 编译说明

1. 打开Keil uVision
2. 打开项目文件 `CODE/Project.uvproj`
3. 选择芯片型号：STC89C516RD+
4. 点击编译按钮（F7）
5. 生成的HEX文件位于 `CODE/Objects/Project.hex`

## 仿真说明

### 重要提示

由于Proteus元件库中可能没有STC89C516芯片，仿真时可以使用AT89C52代替：

- **原因**：STC89C516与AT89C52引脚完全兼容，指令集相同
- **影响**：对本项目的功能仿真没有任何影响
- **说明**：实际硬件使用STC89C516，仿真使用AT89C52

### 仿真步骤

1. 打开Proteus
2. 打开仿真文件 `仿真/双人弹球游戏仿真.pdsprj`
3. 如需替换芯片，请参考 `Proteus芯片替换说明.md`
4. 加载编译生成的HEX文件到单片机
5. 点击运行按钮开始仿真

## 硬件连接

```
STC89C516单片机
├─ P0口 → LED点阵屏行选择（低电平有效）
├─ P3.4 → 74HC595 SER（串行数据）
├─ P3.5 → 74HC595 RCLK（锁存时钟）
├─ P3.6 → 74HC595 SRCLK（移位时钟）
├─ P3.0 → 按键K2（玩家1下移）
├─ P3.1 → 按键K1（玩家1上移）
└─ P1口 → 玩家2按键矩阵（S15/S16）

74HC595输出 → LED点阵屏列数据（高电平点亮）
```

## 操作说明

### 游戏开始
- 上电后显示开始界面
- 按下 **K1** 键开始游戏

### 玩家1控制（左侧球拍）
- **K1**（P3.1）：球拍上移
- **K2**（P3.0）：球拍下移

### 玩家2控制（右侧球拍）
- **S15**（P1.4）：球拍上移
- **S16**（P1.4）：球拍下移

### 游戏规则
- 球每500ms移动一次
- 球碰到上下边界会反弹
- 球碰到左右边界会改变方向
- 如果球未被球拍接住，对方玩家获胜
- 游戏结束后显示胜利动画，然后自动重启

## 技术特点

1. **模块化设计**：代码结构清晰，易于维护
2. **动态扫描显示**：LED点阵屏刷新率125Hz，无闪烁
3. **定时器中断**：精确控制球的移动速度
4. **按键消抖**：软件消抖，响应灵敏
5. **I/O扩展**：使用74HC595节省单片机引脚

## 芯片变更说明

本项目原使用AT89C52芯片，现已升级为STC89C516：

### 升级原因
- STC89C516具有更大的存储空间（64KB ROM vs 8KB ROM）
- 更大的RAM（1280字节 vs 256字节）
- 更好的性能和稳定性
- 国产芯片，成本更低

### 兼容性
- 引脚完全兼容
- 指令集完全兼容
- 代码无需修改（仅头文件使用通用的REGX52.H）
- 仿真可继续使用AT89C52

### 已修改的文件
- ✅ `CODE/Project.uvproj` - Keil项目配置
- ✅ `实验报告.md` - 更新芯片型号
- ✅ `答辩发言稿.md` - 更新芯片型号
- ℹ️ `仿真文件` - 可选，参考《Proteus芯片替换说明.md》

## 文档说明

- **实验报告.md**：详细的实验报告，包含硬件设计、软件设计、测试结果等
- **答辩发言稿.md**：答辩演讲稿，包含项目介绍、技术实现、常见问题解答等
- **Proteus芯片替换说明.md**：如何在Proteus中替换芯片的详细步骤

## 常见问题

### Q1: 编译时提示找不到STC89C516？
**A**: 确保Keil中安装了STC芯片支持包。如果没有，可以在项目设置中选择通用的8051芯片，代码仍然可以正常编译。

### Q2: 仿真时找不到STC89C516芯片？
**A**: 使用AT89C52代替，两者完全兼容。参考《Proteus芯片替换说明.md》。

### Q3: 实际硬件使用什么芯片？
**A**: 使用STC89C516芯片。如果没有，也可以使用STC89C52或AT89C52，但需要注意存储空间限制。

### Q4: 如何烧录程序到STC芯片？
**A**: 使用STC官方的下载工具（STC-ISP），通过串口下载HEX文件到芯片。

## 版本历史

- **v1.1** (2025-10-31)
  - 芯片升级为STC89C516
  - 更新项目文档
  - 添加芯片替换说明

- **v1.0** (初始版本)
  - 基于AT89C52的初始实现
  - 完成基本游戏功能

## 作者

- 开发者：[姓名]
- 指导教师：[教师姓名]
- 开发时间：2025年10月

## 许可证

本项目仅供学习和研究使用。

## 致谢

感谢指导老师的悉心指导和帮助！

